@page "/"

@using MudBlazor
@using ScrumMaster.Models

<!-- Home page displaying Scrum tasks in a table with CRUD functionality -->
<MudPaper Class="pa-4">

    <!-- Toolbar with Add and Reset buttons -->
    <MudStack Class="pt-4 pb-4 pr-4" Row="true">
        <!-- Add new row button -->
        <MudTooltip Text="Add Row">
            <MudIconButton Variant="Variant.Filled" Color="Color.Primary" Size="Size.Small"
                           Icon="@Icons.Material.Rounded.Add" OnClick="AddRow" />
        </MudTooltip>

        <!-- Reset all data button -->
        <MudTooltip Text="Reset All">
            <MudIconButton Variant="Variant.Filled" Color="Color.Primary" Size="Size.Small"
                           Icon="@Icons.Material.Rounded.Restore" OnClick="ResetData" />
        </MudTooltip>
    </MudStack>

    <!-- Scrum items table -->
    <MudTable Items="Items" Hover="true" Bordered="true" Striped="true">

        <!-- Table header -->
        <HeaderContent>
            <MudTh>Assigned To</MudTh>
            <MudTh>Project</MudTh>
            <MudTh>Item Id</MudTh>
            <MudTh>Description</MudTh>
            <MudTh>Status</MudTh>
            <MudTh>Actions</MudTh>
        </HeaderContent>

        <!-- Table rows bound to ScrumDetails -->
        <RowTemplate Context="context">

            <!-- Assigned To dropdown -->
            <MudTd>
                <MudSelect T="int" @bind-Value="context.UserId" Dense="true">
                    @foreach (var user in Users)
                    {
                        <MudSelectItem Value="@user.Id">@user.UserName</MudSelectItem>
                    }
                </MudSelect>
            </MudTd>

            <!-- Project dropdown -->
            <MudTd>
                <MudSelect T="int" @bind-Value="context.ProjectId" Dense="true">
                    @foreach (var project in Projects)
                    {
                        <MudSelectItem Value="@project.Id">@project.Name</MudSelectItem>
                    }
                </MudSelect>
            </MudTd>

            <!-- Item Id text field -->
            <MudTd>
                <MudTextField T="string" @bind-Value="context.ItemId" Immediate="true" />
            </MudTd>

            <!-- Description text area -->
            <MudTd>
                <MudTextField T="string" Lines="2" @bind-Value="context.Description" Immediate="true" />
            </MudTd>

            <!-- Status dropdown -->
            <MudTd>
                <MudSelect T="ScrumDetails.ScrumStatus" @bind-Value="context.Status" Dense="true">
                    @foreach (var status in Enum.GetValues<ScrumDetails.ScrumStatus>())
                    {
                        <MudSelectItem Value="@status">@status</MudSelectItem>
                    }
                </MudSelect>
            </MudTd>

            <!-- Row actions: Save and Delete -->
            <MudTd>
                <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="() => SaveChanges(context)">
                    Save
                </MudButton>
                <MudButton Variant="Variant.Filled" Color="Color.Error" OnClick="() => Remove(context)">
                    Delete
                </MudButton>
            </MudTd>
        </RowTemplate>
    </MudTable>
</MudPaper>
