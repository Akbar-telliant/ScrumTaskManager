@page "/admin/user-management"

@using MudBlazor
@using ScrumMaster.Models

<!-- Main container for User Management page -->
<MudContainer>
    <MudStack Spacing="2" Class="pa-4">      
        
        <MudStack>
            <MudText Typo="Typo.h4" Color="Color.Primary">User Management</MudText>
            <MudText Typo="Typo.subtitle1">Manage users, roles, and permissions.</MudText>
        </MudStack>
        <MudStack Style="width:50px;">
          <MudIconButton Class="add-btn" Size="Size.Small" Color="Color.Primary" Variant="Variant.Filled" 
                         Icon="@Icons.Material.Rounded.Add" OnClick="AddUserAsync" />
        </MudStack>

        <!-- Table displaying list of users -->
        <MudTable Items="@m_users" Bordered="true" Hover="true" Striped="true" Dense="true" FixedHeader="true" FixedFooter="true">
            <HeaderContent>
                <MudTh>User Name</MudTh>
                <MudTh>Email</MudTh>
                <MudTh>Role</MudTh>
                <MudTh>Created At</MudTh>
                <MudTh>Actions</MudTh>
            </HeaderContent>

            <RowTemplate Context="user">
                <MudTd>@user.UserName</MudTd>
                <MudTd>@user.Email</MudTd>
                <MudTd>
                    <MudChip T="string" Color="@(user.Role == UserDetails.TUserRole.Admin ? Color.Primary : null)"
                             Variant="Variant.Filled">
                        @user.Role.ToString()
                    </MudChip>
                </MudTd>
                <MudTd>@user.CreatedAt.ToShortDateString()</MudTd>
                <MudTd>
                    <MudTooltip Text="@("Edit " + @user.UserName)">
                        <MudIconButton Variant="Variant.Text" Size="Size.Small" Color="Color.Primary" Icon="@Icons.Material.Rounded.Edit"
                                       OnClick="@(() => EditUserAsync(user))" />
                    </MudTooltip>
                    <MudTooltip Text="@("Delete " + @user.UserName)">
                        <MudIconButton Variant="Variant.Text" Size="Size.Small" Color="Color.Error" Icon="@Icons.Material.Rounded.Delete"
                                       OnClick="@(() => DeleteUserAsync(user))" />
                    </MudTooltip>
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager />
            </PagerContent>
        </MudTable>
    </MudStack>
</MudContainer>
